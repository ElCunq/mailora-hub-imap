<!doctype html><html lang="en"><head><meta charset="utf-8"/><title>Mailora IMAP Hub Test</title><meta name="viewport" content="width=device-width,initial-scale=1"/><style>body{margin:0;font:14px system-ui;background:#0f1217;color:#e5e7eb}header{padding:16px 24px;background:#111827;border-bottom:1px solid #1f2937}h1{margin:0;font-size:20px}main{max-width:960px;margin:24px auto;padding:0 16px;display:grid;gap:24px}section{background:#1b2230;border:1px solid #243043;border-radius:12px;padding:16px}input,button{background:#111827;border:1px solid #334155;color:#e5e7eb;padding:8px 10px;border-radius:8px;font:14px system-ui}button{cursor:pointer}button:hover{border-color:#475569}pre{background:#0b0e13;padding:12px;border-radius:8px;overflow:auto;font-size:13px}label{display:block;font-size:12px;margin-top:8px;color:#94a3b8} .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center} .ok{color:#10b981}.err{color:#ef4444}.grid2{display:grid;grid-template-columns:1fr 1fr;gap:16px} @media (max-width:800px){.grid2{grid-template-columns:1fr}}</style></head><body><header><h1>Mailora IMAP Hub – Test UI</h1></header><main>
<section><h2>1. Login (IMAP Doğrulama)</h2><div class="row"><input id="login_email" placeholder="email"/><input id="login_pass" type="password" placeholder="password"/></div><div class="row"><input id="login_host" placeholder="imap host (opsiyonel)" style="flex:1"/><input id="login_port" placeholder="993" style="width:90px"/><button id="btnLogin">Login</button></div><pre id="login_out" style="margin-top:8px;font-size:12px;min-height:60px"></pre></section>
<section><h2>2. Diff (Initial Snapshot)</h2><div class="row"><input id="accountId" value="1" style="width:120px"/><button id="btnDiff">GET /diff</button><input id="cursor" placeholder="since token" style="flex:1"/></div><pre id="diff_out">(sonuç)</pre></section>
<section class="grid2"><div><h2>3. Body</h2><div class="row"><input id="body_uid" placeholder="UID" style="flex:1"/><button id="btnBody">GET /body</button></div><pre id="body_out">(sonuç)</pre></div><div><h2>4. Attachments (TODO)</h2><div class="row"><input id="att_msg" placeholder="messageId" style="flex:1" disabled/><button disabled>GET /attachments</button></div><pre>(yakında)</pre></div></section>
<section><h2>5. Send</h2><div class="row"><input id="send_to" placeholder="to" style="flex:1"/><input id="send_subject" placeholder="subject" style="flex:1"/><button id="btnSend">POST /action</button></div><textarea id="send_body" style="width:100%;height:120px;background:#111827;border:1px solid #334155;color:#e5e7eb;margin-top:8px;border-radius:8px;padding:8px" placeholder="Body"></textarea><pre id="send_out">(sonuç)</pre></section>
<section><h2>6. Events (TODO)</h2><pre>(yakında)</pre></section>
<section><h2>Folders</h2><div class="row"><button id="btnFolders">GET /folders</button></div><pre id="folders_out">(sonuç)</pre></section>
<section><h2>Attachments</h2><div class="row"><input id="att_uid" placeholder="UID" style="flex:1"/><button id="btnAtt">GET /attachments</button></div><pre id="att_out">(sonuç)</pre></section>
<section><h2>Debug</h2><div class="row"><button id="btnDbgState">GET /debug/state</button><button id="btnDbgProbe">GET /debug/probe</button></div><pre id="dbg_out">(sonuç)</pre></section>
</main><script>const $=id=>document.getElementById(id);function j(v){return JSON.stringify(v,null,2)}
$('btnLogin').onclick=async()=>{const email=$('login_email').value.trim();const password=$('login_pass').value.trim();const host=$('login_host').value.trim();const port=$('login_port').value.trim();const body={email,password};if(host)body.host=host;if(port)body.port=parseInt(port,10);$('login_out').textContent='Gönderiliyor...';$('login_out').className='';try{const res=await fetch('/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(body)});const txt=await res.text();let js;try{js=JSON.parse(txt);}catch{ $('login_out').textContent=txt; $('login_out').className='err'; return;}$('login_out').textContent=j(js);$('login_out').className=js.ok?'ok':'err';}catch(e){$('login_out').textContent='İstek hatası '+e; $('login_out').className='err';}};
$('btnDiff').onclick=async()=>{const acc=$('accountId').value.trim();let url='/diff?accountId='+encodeURIComponent(acc);const c=$('cursor').value.trim();if(c)url+='&since='+encodeURIComponent(c);const res=await fetch(url);const txt=await res.text();try{const js=JSON.parse(txt);$('diff_out').textContent=j(js);if(js.next)$('cursor').value=js.next;}catch{ $('diff_out').textContent=txt; }};
$('btnBody').onclick=async()=>{const acc=$('accountId').value.trim();const uid=$('body_uid').value.trim();if(!uid)return;const res=await fetch(`/body?accountId=${encodeURIComponent(acc)}&uid=${encodeURIComponent(uid)}`);const txt=await res.text();try{const js=JSON.parse(txt);$('body_out').textContent=j(js);}catch{ $('body_out').textContent=txt; }};
$('btnSend').onclick=async()=>{const acc=$('accountId').value.trim();const to=$('send_to').value.trim();if(!to)return;const subject=$('send_subject').value.trim();const body=$('send_body').value;const res=await fetch('/action',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({accountId:acc,to,subject,body})});const txt=await res.text();try{const js=JSON.parse(txt);$('send_out').textContent=j(js);}catch{ $('send_out').textContent=txt; }};
$('btnFolders').onclick=async()=>{const acc=$('accountId').value.trim();const res=await fetch(`/folders?accountId=${encodeURIComponent(acc)}`);const txt=await res.text();try{const js=JSON.parse(txt);$('folders_out').textContent=j(js);}catch{ $('folders_out').textContent=txt; }};
$('btnAtt').onclick=async()=>{const acc=$('accountId').value.trim();const uid=$('att_uid').value.trim();if(!uid)return;const res=await fetch(`/attachments?accountId=${encodeURIComponent(acc)}&uid=${encodeURIComponent(uid)}`);const txt=await res.text();try{const js=JSON.parse(txt);$('att_out').textContent=j(js);}catch{ $('att_out').textContent=txt; }};
$('btnDbgState').onclick=async()=>{const res=await fetch('/debug/state');const t=await res.text();try{$('dbg_out').textContent=j(JSON.parse(t));}catch{$('dbg_out').textContent=t;}};
$('btnDbgProbe').onclick=async()=>{const acc=$('accountId').value.trim();const res=await fetch(`/debug/probe?accountId=${encodeURIComponent(acc)}`);const t=await res.text();try{$('dbg_out').textContent=j(JSON.parse(t));}catch{$('dbg_out').textContent=t;}};</script></body></html>